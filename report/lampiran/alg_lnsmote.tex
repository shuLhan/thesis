\begin{algorithm}[h]
	\caption{Local Neighbourhood SMOTE}
	\label{alg:lnsmote}
	\begin{algorithmic}[1]
\Require \\
S: dataset sampel keseluruhan \\
P: sample minoritas dari $ S $ \\
o: rasio \textit{over-sampling}, jumlah sampel sintetis yang akan dibuat \\

\Function{LNSMOTE}{$ S, P, o $}
	\State $ SEEDS \gets P $
	\State $ OUT \gets S $
	\For{\textbf{each} $ p $ \textbf{in} $ SEEDS $}
		\State $ NN \gets \Call{KNearestNeighbor}{S, p} $
		\For{$ i \gets 1 \dots o $}
			\State $ s \gets \Call{CreateSynthetic}{p, NN, S} $

			\If{$ s \not= nil $}
				\State tambahkan $ s $ ke $OUT$
			\EndIf
		\EndFor
	\EndFor
	\State \Return{OUT}
\EndFunction
\\
\Function{CreateSynthetic}{$ p, NN, S $}
	\State $ n \gets $ pilih \textit{nearest neighbourhood} secara acak
	pada $ NN $
	\If{\textbf{not} \Call{CanCreate}{$ S, p, n $}}
		\State \Return nil
	\EndIf

	\State $ x_{new} \gets \Call{Clone}{p} $
	\For{\textbf{each} $ a $ \textbf{in} \Call{Attributes}{S}}a
		\If{\Call{IsQuantitative}{$ a $}}
			\State $ \delta \gets \Call{RandomGap}{S, p, n} $
			\State $ diff \gets n(a) - p(a) $
			\State $ x_{new}(a) \gets p(a) + \delta \cdot diff $
		\Else
			\State $ x_{new} \gets \Call{MostFrequent}{p \cup NN, a} $
		\EndIf
	\EndFor

	\State \Return $ x_{new} $
\EndFunction
	\algstore{lnsmote_break}
	\end{algorithmic}
\end{algorithm}

\begin{algorithm}[h]
	\caption{Local Neighbourhood SMOTE bagian 2}
	\begin{algorithmic}[1]
	\algrestore{lnsmote_break}

\Function{CanCreate}{$ S, p, n $}
	\State $ slp \gets \Call{SafeLevel}{S, p} $
	\State $ sln \gets \Call{SafeLevel2}{S, p, n} $
	\State \Return{$ slp \not= 0 $ \textbf{or} $ sln \not= 0 $}
\EndFunction
\\
\Function{SafeLevel}{$ S, p $}
	\State $ pneighbor \gets \Call{KNearestNeighbor}{S, p} $
	\State \Return{$ pneighbor $ yang kelasnya minoritas}
\EndFunction
\\
\Function{SafeLevel2}{$ S, p, n $}
	\State $ nneighbor \gets \Call{KNearestNeighbor}{ S, n } $
	\If{$\Call{Class}{n} \not= P $ \textbf{and} $ p \in nneighbor $}
		\State Ganti $ p $ di $ nneighbor $ dengan tetanggga $ k + 1 $
		dari $ n $
	\EndIf
	\State \Return{$ nneighbor $ yang kelasnya minoritas}
\EndFunction
\\
\Function{RandomGap}{$ S, p, n $}
	\State $ slp \gets \Call{SafeLevel}{S, p} $
	\State $ sln \gets \Call{SafeLevel}{S, p, n} $
	\State $ \delta \gets 0 $

	\If{$ sln = 0 $ \textbf{and} $ slp > 0 $}
		\State \Return{$ \delta $}
	\EndIf
	\\
	\State $ slratio \gets \frac{slp}{sln} $
	\If{$ slratio = 1 $}
		\State $ \delta \gets \Call{Random}{1} $
	\ElsIf{$ slratio > 1 $}
		\State $ \delta \gets \Call{Random}{\frac{1}{slratio}} $
	\Else
		\State $ \delta = 1 - \Call{Random}{slratio} $
	\EndIf
	\\
	\If{$ \Call{Class}{n} \not= P $}
		\State $ \delta = \delta \cdot \frac{sln}{k} $
	\EndIf
	\\
	\State \Return{$ \delta $}
\EndFunction
	\end{algorithmic}
\end{algorithm}
